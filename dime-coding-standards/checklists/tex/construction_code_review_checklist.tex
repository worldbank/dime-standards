\documentclass{tufte-handout}

\usepackage{librecaslon}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{tcolorbox} 
\usepackage{xcolor}
\usepackage{setspace}
\usepackage{graphics}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    urlcolor=cyan,
}

% Set header and footer
\pagestyle{fancy}
\fancyhf{}
\lfoot{\includegraphics[height=1cm,keepaspectratio]{../../img/wb}}
\rfoot{\includegraphics[height=1cm,keepaspectratio]{../../img/analytics}}

% Put checkbox to the left of the text
\def\LayoutCheckField#1#2{% label, field
    #2 #1%
}
% Adjust footer spacing
\setlength{\footskip}{2cm}
% Line spacing
\onehalfspacing

% Define DIME Analytics visual identity colors
\definecolor{fontcolor}{HTML}{7A0569}

\titleformat{\section}%
{\Large\rmfamily\bf\color{fontcolor}}% format applied to label+text
{\llap{\colorbox{fontcolor}{\parbox{1.5cm}{\hfill\huge\color{fontcolor}\thesection}}}}% label
{2pt}% horizontal separation between label and title body
{}% before the title body
[]% after the title body

\titleformat{\subsection}%
{\large\rmfamily\color{fontcolor}}% format applied to label+text
{}% label
{1.5pt}% horizontal separation between label and title body
{}% before the title body
[]% after the title body

\newcommand{\dimeCheckBox}[1]{\CheckBox[height=0.01cm, width=0.4cm, bordercolor=gray]{#1}}
\newcommand{\dimeTextField}[3]{\TextField[name=#1, height=0.3cm, width=#2, bordercolor=gray]{#3}}

\newcommand{\titleBox}[1]{
    \begin{tcolorbox}
        [colframe = fontcolor,
        colback = fontcolor,
        sharp corners,
        halign = flush center,
        valign = center,
        height = 0.3\textwidth,
        after skip = 1cm]
        #1
    \end{tcolorbox}
}

\begin{document}
    \begin{fullwidth}
        
        \titleBox{
            \textcolor{white}{\LARGE{\textbf{DIME Analytics \\ Peer Code Review - Construction Checklist}}}
        }

        \section*{Reviewer Details}
        \dimeTextField{reviewer}{6cm}{Reviewer Name:}  
        \dimeTextField{coder}{6cm}{ Coder Name:}  

        \vspace{0.5cm}

        \textbf{NOTE:} Please complete this checklist \textbf{only if} your partner's submission includes \textbf{indicator construction} tasks.  

        \section*{Indicator Construction Tasks}
        This checklist highlights key aspects to review in your partner's \textbf{construction scripts/code}.  
        Once completed, please submit it as an attachment along with \href{https://survey.wb.surveycto.com/collect/code_review_summary?caseid=}{this form}.
      
\subsection*{Variable Construction Checks}
       \begin{itemize}
    \item[] \dimeCheckBox{Each variable's purpose and construction logic aligns with its documented definition (e.g., codebook, project documentation).}
    \item[] \dimeCheckBox{Correct functions are used and properly explained (e.g., transformations, normalizations).}
    \item[] \dimeCheckBox{Categorical variables are properly encoded (e.g., labeled factors in Stata/R).}
 
      \end{itemize}         
      
        \subsection*{Merge Checks}
        \begin{itemize}
            \setlength\itemsep{0.3em}
            \item[] \dimeCheckBox{If any observations are dropped, a clear justification is provided in the code.}
            \item[] \dimeCheckBox{Any mismatches between datasets are explicitly explained in the code.}
             \item[] \dimeCheckBox{m:m merge is NOT perfomed}
        \end{itemize}      
        
         \subsection*{Collapse and group-wise calculations Checks}
        \begin{itemize}
            \setlength\itemsep{0.3em}
            \item[] \dimeCheckBox{Missing values are handled appropriately and documented.}
            \item[] \dimeCheckBox{If sorting affects results, the data is being sorted on a unique or a combination of unique IDs.}
            \item[] \dimeCheckBox{Aggregation functions (sum, mean, etc.) are correctly applied and documented.}
        \end{itemize}      

	
          \subsection*{Winzorization and Outlier handling}
            \begin{itemize}
                \item[] \dimeCheckBox{The choice of winsorization or other outlier-handling techniques is clearly justified.}
                \item[] \dimeCheckBox{Documentation explains how cutoff percentiles were chosen and why one/both tails were modified.}
            \end{itemize}


        \subsection*{Constructed Dataset Checks}     
        \begin{itemize}
            \item[] \dimeCheckBox{The dataset follows a \textbf{tidy} structure: each row represents an observation, and each variable is a column.}
            \item[] \dimeCheckBox{Variable names are informative and follow a consistent naming convention.}
            \item[] \dimeCheckBox{Variable labels provide clear descriptions of their contents.}
           \item[] \dimeCheckBox{Value labels are informative and consistent (e.g., avoiding cases where varA: 1 = yes, 0 = no, but varB: 1 = yes, 2 = no).}
            \item[] \dimeCheckBox{All labels are grammatically correct and do not contain special characters.}
            \item[] \dimeCheckBox{Documentation (variable dictionary, variable labels, value labels, comments) is complete and consistent  (e.g. codebook constructed using iecodebook).}
            \item[] \dimeCheckBox{Each row has a unique ID (or valid combination of unique keys).}
            \item[] \dimeCheckBox{The constructed dataset is saved only once throughout the script and is not overwritten multiple times.}
        \end{itemize}

        \vspace{0.6em}

    \end{fullwidth}
\end{document}
